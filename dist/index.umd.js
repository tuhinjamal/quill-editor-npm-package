(function(u,l){typeof exports=="object"&&typeof module<"u"?l(exports,require("vue"),require("element-plus"),require("quill")):typeof define=="function"&&define.amd?define(["exports","vue","element-plus","quill"],l):(u=typeof globalThis<"u"?globalThis:u||self,l(u.Vue3QuillEditor={},u.Vue,u.elementPlus,u.Quill))})(this,function(u,l,f,H){"use strict";const I=(h,g)=>{const C=h.__vccOpts||h;for(const[y,E]of g)C[y]=E;return C},R={class:"editor-container"},M=I({__name:"QuillEditor",props:["modelValue","Placeholder"],emits:["update:modelValue"],setup(h,{emit:g}){const C=h,y=g,E=l.ref(null),w=l.ref(null),Q=l.ref(null);let a,O=0,k=!1;const x=l.ref(0),T=l.ref(!1),d=l.ref(null),v=l.ref(!1),S=l.ref(0),q=l.ref(0);l.onMounted(()=>{a=new H(E.value,{theme:"snow",placeholder:C.Placeholder,modules:{toolbar:[[{size:[]}],["bold","italic","underline","strike"],[{color:[]},{background:[]}],[{script:"sub"},{script:"super"}],[{header:[1,2,3,4,5,6,!1]}],[{align:[]}],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],["link","image","video"],["clean"]]}});const e=a.getModule("toolbar").container,t=document.createElement("button");t.title="Insert Table",t.innerHTML="&#9016;",t.classList.add("ql-insertTable"),t.onclick=s=>{s.preventDefault();const J=a.getSelection();D(0,x,J)},e.appendChild(t);const n=document.createElement("button");n.title="Delete Last Row",n.innerHTML="&#7035;",n.onclick=s=>{s.preventDefault(),$()},e.appendChild(n);const o=document.createElement("button");o.title="Delete Last Column",o.innerHTML="&#9030;",o.onclick=s=>{s.preventDefault(),W()},e.appendChild(o),a.root.innerHTML=C.modelValue||"",a.on("text-change",()=>{y("update:modelValue",a.root.innerHTML),L()});const c=document.createElement("button");c.title="Merge Cells",c.innerHTML="←→",c.onclick=s=>{s.preventDefault(),A()},e.appendChild(c);const i=document.createElement("button");i.title="Clear Cell",i.innerHTML="X",i.onclick=s=>{s.preventDefault(),B()},e.appendChild(i);const r=document.createElement("button");r.title="Insert Column Left",r.innerHTML="←",r.onclick=s=>{s.preventDefault(),V()},e.appendChild(r);const m=document.createElement("button");m.title="Insert Column Right",m.innerHTML="→",m.onclick=s=>{s.preventDefault(),_()},e.appendChild(m);const p=document.createElement("button");p.title="Delete Column",p.innerHTML="&#1154;",p.onclick=s=>{s.preventDefault(),N()},e.appendChild(p);const b=document.createElement("button");b.title="Delete Table",b.innerHTML="🗑️",b.onclick=s=>{s.preventDefault(),K()},e.appendChild(b),a.root.addEventListener("keydown",G),a.root.addEventListener("click",P),a.root.addEventListener("contextmenu",U),L()});const D=async(e,t,n=null)=>{const o=typeof t=="object"&&"value"in t?t.value:t,c=l.ref({rows:2,columns:o||2});try{await f.ElMessageBox({title:"Insert Table",message:()=>l.h("div",{style:"padding: 10px 0"},[l.h(f.ElForm,{labelPosition:"top",size:"small"},()=>[l.h(f.ElFormItem,{label:"Rows"},()=>l.h(f.ElInputNumber,{modelValue:c.value.rows,"onUpdate:modelValue":r=>c.value.rows=r,min:1})),l.h(f.ElFormItem,{label:"Columns"},()=>l.h(f.ElInputNumber,{modelValue:c.value.columns,"onUpdate:modelValue":r=>{c.value.columns=r,k||(O=r,k=!0)},min:1}))])]),confirmButtonText:"Insert",cancelButtonText:"Cancel",beforeClose:(r,m,p)=>{if(r==="confirm"&&(!c.value.rows||!c.value.columns)){f.ElMessage.error("Please enter valid numbers.");return}p()}});const i=z(c.value.rows,c.value.columns);j(i,n),L(),x.value=c.value.columns}catch{}},z=(e,t)=>{const n=document.createElement("table");n.setAttribute("class","quill-table"),n.setAttribute("border","1"),n.setAttribute("cellspacing","0"),n.setAttribute("cellpadding","5"),n.style.width="100%",n.style.borderCollapse="collapse";for(let o=0;o<e;o++){const c=document.createElement("tr");for(let i=0;i<t;i++){const r=document.createElement("td");r.innerHTML="<br>",r.style.minWidth="50px",r.style.border="1px solid #ccc",c.appendChild(r)}n.appendChild(c)}return n},j=(e,t)=>{const n=document.createElement("div");n.appendChild(e);const o=n.innerHTML,c=t?t.index:a.getLength();a.clipboard.dangerouslyPasteHTML(c,o)},L=()=>{E.value.querySelectorAll("table").forEach(t=>{t.style.width="100%",t.style.borderCollapse="collapse",t.style.margin="10px 0",t.querySelectorAll("td, th").forEach(o=>{o.style.border="1px solid #aaa",o.style.padding="6px",o.style.textAlign="center",o.style.position="relative",o.style.cursor="text",F(o)})})};function F(e){const t=document.createElement("div");t.className="resize-grip",e.appendChild(t);let n,o;t.addEventListener("mousedown",r=>{r.stopPropagation(),n=r.clientX,o=parseInt(document.defaultView.getComputedStyle(e).width,10),document.documentElement.addEventListener("mousemove",c),document.documentElement.addEventListener("mouseup",i)});function c(r){e.style.width=`${o+r.clientX-n}px`}function i(){document.documentElement.removeEventListener("mousemove",c),document.documentElement.removeEventListener("mouseup",i)}}function P(e){const t=e.target.closest("td");if(t){d.value=t,T.value=!0;const n=t.getBoundingClientRect(),o=10;w.value.style.top=`${n.top+window.scrollY-o}px`,w.value.style.left=`${n.left+window.scrollX+o}px`}else T.value=!1}const V=()=>{const e=Array.from(d.value.parentNode.children).indexOf(d.value);d.value.closest("table").querySelectorAll("tr").forEach(n=>{const o=n.children[e].cloneNode(!0);o.innerText="",n.insertBefore(o,n.children[e])})},_=()=>{const e=Array.from(d.value.parentNode.children).indexOf(d.value);d.value.closest("table").querySelectorAll("tr").forEach(n=>{const o=n.children[e].cloneNode(!0);o.innerText="",n.insertBefore(o,n.children[e+1])})};function U(e){const t=e.target.closest("td");t&&(e.preventDefault(),d.value=t,v.value=!0,S.value=e.pageX,q.value=e.pageY)}const A=()=>{const e=d.value,t=e.nextElementSibling;e&&t&&(e.colSpan=(e.colSpan||1)+1,e.innerHTML+=" "+t.innerHTML,t.remove())},Y=()=>{var e,t;(t=(e=d.value)==null?void 0:e.parentElement)==null||t.remove()},N=()=>{const e=Array.from(d.value.parentNode.children).indexOf(d.value);d.value.closest("table").querySelectorAll("tr").forEach(n=>n.deleteCell(e))},B=()=>{d.value.innerText=""};function $(){const e=a.root.querySelectorAll("table"),t=e[e.length-1],n=t.querySelectorAll("tr");n.length>1?t.deleteRow(n.length-1):t.remove()}function W(){const e=a.root.querySelectorAll("table");e[e.length-1].querySelectorAll("tr").forEach(n=>{const o=n.querySelectorAll("td, th");o.length>0&&n.deleteCell(o.length-1)})}function K(){const e=a.root.querySelectorAll("table"),t=e[e.length-1];t&&t.remove()}const G=e=>{if(!["Enter","Tab"].includes(e.key))return;const t=window.getSelection();if(!t||t.rangeCount===0)return;const o=t.getRangeAt(0).startContainer,c=o.nodeType===Node.TEXT_NODE?o.parentElement:o,i=c==null?void 0:c.closest("td");if(!i)return;const r=i.parentElement,m=r==null?void 0:r.closest("table");if(!m)return;const p=r===m.querySelector("tr:last-child"),b=i===r.querySelector("td:last-child");p&&b&&(e.preventDefault(),D(1,x))};return l.onMounted(()=>{window.addEventListener("click",()=>v.value=!1)}),l.onUnmounted(()=>{window.removeEventListener("click",()=>v.value=!1)}),(e,t)=>(l.openBlock(),l.createElementBlock("div",R,[l.createElementVNode("div",{ref_key:"quillEditor",ref:E,class:"quill-editor"},null,512),l.withDirectives(l.createElementVNode("div",{ref_key:"tableControls",ref:w,class:"table-controls"},[l.createElementVNode("button",{onClick:l.withModifiers(V,["prevent"])},"⬅ Col ➕ |"),l.createElementVNode("button",{onClick:l.withModifiers(_,["prevent"])},"➕ Col ➡")],512),[[l.vShow,T.value]]),l.withDirectives(l.createElementVNode("ul",{ref_key:"contextMenu",ref:Q,class:"context-menu",style:l.normalizeStyle({top:q.value-400+"px",left:S.value-400+"px",position:"absolute"})},[l.createElementVNode("li",{class:"cursor-pointer",onClick:l.withModifiers(A,["prevent"])},"Merge Cells"),l.createElementVNode("li",{class:"cursor-pointer",onClick:l.withModifiers(Y,["prevent"])},"Delete Row"),l.createElementVNode("li",{class:"cursor-pointer",onClick:l.withModifiers(N,["prevent"])}," Delete Column "),l.createElementVNode("li",{class:"cursor-pointer",onClick:l.withModifiers(B,["prevent"])},"Clear Cell")],4),[[l.vShow,v.value]])]))}},[["__scopeId","data-v-b580d7e2"]]),X={install(h){h.component("QuillEditor",M)}};u.QuillEditor=M,u.default=X,Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
